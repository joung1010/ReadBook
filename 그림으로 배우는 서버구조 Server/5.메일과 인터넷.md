## 메일과 인터넷을 지원하는 서버

1. 메일과 인터넷의 등장인물
메일은 송신을 담당하는 **SMT 서버 와 DNS 서버**, 수신을 담당하는 **POP3 서버**  
인터넷의 경우는 **DNS, Proxy, Web, SSL, FTP**등의 서버로 구성  
```
메일 : SMTP 서버(메일 송신), POP3 서버(메일 수신), IMAP 서버(외부에서의 메일 열람),
       DNS 서버(도메인과 IP 주소 관리), Proxy 서버(인터넷 통신 대행), SSL 서버(통신 암호화)
       
인터넷 : DNS 서버(도메인과 IP 주소 관리), Proxy 서버(인터넷 통신 대행), SSL 서버(통신 암호화)       
        Web 서버(웹 서비스 제공), FTP 서버(파일 전송및 공유)
```

## 메일을 보내고 받는 서버

1. SMTP 서버의 역할  
**SMTP 서버**(Simple Mail Transfer Protocol)는 메일을 보내는 프로토콜을 사용한다.
메일을 보내고 받는 프로토콜이 다르므로 서버도 각각 따로 있다.  
```
      송신 측 기업                               수신 측 기업
        
        DNS 서버
           ↑  2. 도메인명에서 상대의 SMPT 서버를
           |      DNS 서버에 문의 한다.
           |
           
        SMTP 서버       -------------->           SMTP 서버
        
           ↑               3. 상대의 SMTP 서버에
           |                  메일을 보낸다.
           |
           | 1. SMTP 서버에 메일 데이터를 보낸다
          사용자 A
```
SMTP 서버는 메일 주소의 @ 뒤에 적혀 있는 도메인명을 확인해서 DNS 서버에 IP주소를 문의한다.  
IP 주소를 확인 했으면 메일 데이터를 보냅니다.  
메일을 보낼 때 메일 소프트웨어에 설정된 사용자 이름과 암호로 인증하고  
실행하는 절차는 SMTP AUTH 등으로 부른다.  

2. POP3 서버의 역할
**POP3 서버**(Popst Office Protocol Version 3)는 메일을 받는 프로토콜을 이용한다.  
앞에서 SMTP 서버는 서버에서 보내는 쪽 SMTP 서버와 받는 쪽 창구가 되는 SMTP 서버가 있습니다.  
```
  송신 측 기업                             수신 측 기업
  
                                  1. SMTP 서버를 경유해 메일이 POP3 서버에 수시로 도달한다.

    SMTP 서버           ----->        SMTP 서버     ------->          POP3 서버
                                                                          |  
                                                    정기적으로 문의        |
                                                    <-------              |     2. 클라이언트가 문의
                                                                          |        하는 계정 이름, 암호가
                                                                          ↓      맞으면 편지함에 저장되어
                                                                                 있는 메일을 보낸다.
                                                                        사용자
```  
보내는 쪽 SMTP 서버에서 받는 쪽 기업의 SMTP 서버로 SMTP 서버 간의 통신에 의해 메일 데이터가 도달한다.  
그리고 받는 쪽 기업의 SMTP 서버에 사용자가 자기 앞으로 온 메일을 가지러 갈 때 POP3 서버를 이용한다.  
따라서, POP3 서버는 전송 명령이 있으면 곧바로 상대방의 SMTP 서버에 데이터를 보내지만,  
POP3 서버는 메일이 도착했는지 메일 소프트웨어에 설정된 간격으로 정기적으로 확인하는 처리를 한다는 차이도 있다.  

3. SSL로 암호화  
사용자는 메일 소프트웨어에 설정ㅎ나 POP3 서버에 엑세스해서, 자신의 편지함에 도착한 메일 데이터를 받으러간다.  
이때 사용자 이름과 암호에 의한 인증이 필요하다.  
```
                              POP3 서버
                                |   ↑
                                |   | * 사용자 이름    (사용자가 편지함에 저장된
                                |   | * 암호            메일 데이터를 받으러 갈때, 사용자 이름, 암호로
                                ↓   |                   인증을 받는다)

                          -------------
                         | *사용자 이름|
                         | * 암호      |  SSL 로 통신하면, 터널로 정보를 보호할 수 있다.
                         ---------------  개인 단말이라면 메일 설정의 보안 종류에서 기본적으로 없음 으로 되어 있는 부분을 SSL/TLS 등
                                          으로 변경한다.
```  
개인이 메일 수신 설정을 할 때 중요한 것은  
**메일을 가져오는 정기적인 타이밍과 수신한 메일을 서버에서 삭제하는 타이밍일**것이다.  

## 웹 서비스 제공에 꼭 필요한 서버

1. 웹 서버로 가는 길  
**웹 서버**는 웹 서비스를 제공하는 서버이다. 일반적으로 브라우저를 이용해  
웹 사이트를 보는데, 이때 **웹 사이트의 콘테츠를 제공**하는 것이 웹 서버이다.  
하지만, 클라이언트 단말의 브라우저에서 직접 웹 서버로 연결되는 것은 아니다.  
```
                                      웹 서버로 가는 길

  기업이나 단체의 네트워크                                       웹 서비스 제공자의 네트워크
                                                                        SSL 서버
      DNS 서버 URL을 IP 주소로 변환                                           ↖
        ↖↘                                                                     ↘ 
              Proxy 서버    -------------------------------->   Proxy 서버    ⇆   웹서버
              ↗                 조정 후에 인터넷으로                                
        클라이언트 PC              
    
```  
클라이언트 PC 브라우저의 요청을 바탕으로 Proxy 서버를 경유 하고 있다.  
DNS 서버에서 URL을 IP 주소로 변환해 주면 조정을 완료하고, 인터넷을 지나  
목표로 하는 상대방 네트워크에 들어가 웹 서버에 도달합니다.  

2. 웹 서버의 메일 소프트웨어에서의 설정  
웹 서버는 브라우저의 데이터나 처리 요청에 대해서 **HTTP**(Hyper Text Transfer Protocol) 프로토콜에 따라 대응한다.  
```
                                 웹 서버의 처리

                        * 목적지 URL
                        * 메소드(get,post,put,delete 등)
  브라우저            ----------------------------->            웹 서버
                     <-----------------------------             * Window : 서버역할 선택을 웹서버(IIS)를 선택
                        * 요구된 처리를 반환                     * Linux :  Apache, nignx 등의 서버를 이용


일반적인 웹 사이트의 의미: 홈페이지 등 웹 페이지의 집합을 가리키는 말로 사용
IIS에서 웹 사이트의 의미 : 마이크로소프트의 IIS에서 작성한 콘테츠를 공개하는 단위를 뜻하며, 개발자는 이 의미로 사용하는 경우가 많다.

```  
웹 서버의 구조에 관해서는 지금까지처럼 사용자 혹은 클라이언트 중심으로 생각하면 이해하기 쉽다.  
도입을 검토할 때는 **서비스를 제공하는 쪽 시점**에서 생각한다.  

## 도메인과 IP 주소의 연결

1. DNS의 역할  
**DNS**(Domain Name System)은 지금까지도 여러 번 등장했던 것처럼 **도메인명과 IP 주소를 연결해 주는 기능**을 제공한다.  
* 메일 주소 @ 뒤의 도메인명을 IP 주소로 변경한다.  
* 브라우저에서 입력된 도메인명을 IP 주소로 변환한다.  
평소에는 DNS의 존재를 의식하지 못하지만, 메일에서도 웹에서 활약하는 매우 중요한 기능을 제공한다.  
DNS 서버는 크게 캐시 서버와 콘테츠 서버로 나눌 수 있다.  
```
        
            대상 도메인명의 IP                         대상 도메인명의 IP
            주소가 캐시에 있으면 캐시에서 응답           주소가 캐시에 없으면 콘테츠에 문의
    사용자       ------->                            ------->
                <-------      캐시 서버              <-------       DNS 콘테츠 서버
                                                        콘텐츠 서버에서 캐시 서버로
                                                        응답

DNS 캐시 서버 : 클라이언트 요청에 대응
DNS 콘텐츠 서버 : 대응표를 가지고 있어 외부 DNS에도 대응
```  

2. 시스템 규모에 따라 역할이 바뀐다.  
DNS가 중요한 역할을 하는 만큼, **사용자 수와 네트워크 시스템의 규모에 따라서 존재 자체가 바뀐다.**  
소규모 기업이라면 별도의 DNS 서버 대신 메일이나 웹 서버 안에 기능으로써 들어갑니다.
대기업 이라면 메일이나 웹 사이트로의 접속량이 방대하므로, DNS 서버를 설치할 뿐만 아니라,  
메일용과 웹용으로 나누고 거기서 다시 다중화하는 일도 있다.  

## 브라우저와 웹 서버 사이의 암호화  

1. 통신 암호화  
**SSL(Secure Sockets Layer)** 프로토클은 **인터넷상에서 통신을 암호화해, 악의를 가진 제3자에 의한 도청이나 변조 등을 방지하는 것을 목적으로 한다.**  
클라이언트에는 친숙한 웹 브라우저가, 서버에는 SSL 전용 소프트웨어가 있다.  

2. SSL의 흐름  
SSL로 통신한다는 것을 서버와 클라이언트 양쪽에서 확인하는 것부터 시작한다.  
확인 후 서버에서 인증서와 암호화에 필요한 키를 보내, 통신하는 양쪽에 고유한 암호와 복호화가 준비되면 데이터 통신이 진행된다.  
SSL 기능이 없는 경우에는 데이터가 암호화됮 ㅣ않기 때문에, 도청해서 내용을 볼 수 있게 되거나 데이터를 조작할 가능성이 있지만  
SSL 기능이 있으면 안심할 수 있다.  
브라우저에 표시된 웹 사이트의 URL을 주의해서 보다 보면, 개인 정보나 패스워드등을 입력할때  
'http:'에서 'https:'로 바뀌는 경우가 있다. **https로 표시된 때는 SSL이 실행되고 있습니다.**  
* 클라이언트 와 웹 서버 사이에는 SSL 통신하는 것을 확인하고 암호화 순서를 확인한 후 데이터를 주고 받는다.
* SSL은 공통키 및 공개키 암호 방식을 조합한다.  

## 인터넷을 통한 파일 전송 및 공유

1. 파일 전송  
**FTP**(File Transfer Protocol)는 외부와 파일을 인터넷상에서 공유하고, 웹 서버에 파일을 업로드하기 위한 프로토콜이다.  
사내파일 공유는 파일 서버에 대상 파일을 저장함으로써 가능하다.  
반면에 인터넷을 경유해 외부와 파일을 공유할 때는 똑같이 할 수 없다.  
내부 파일 서버일 때는 디렉터리를 지정해서 저장할 수 있지만, 외부 파일 서버일 때는 대상 컴퓨터의 **IP주소와 URL**을 지정해서 접한후  
인증을 받고 나서 전송을 시작한다.  
```
                                                 FTP와 파일 서버의 차이

 기업이나 단체의 네트워크                                       웹 서비스 제공자의 네트워크
                                                                        
      DNS 서버 URL을 IP 주소로 변환                                           
        ↖↘                                                                     
              Proxy 서버    -------------------------------->   Proxy 서버    ⇆   웹서버      ---------------    
              ↗                                                              (외부 파일 서버)| * 파일 작성  |
        클라이언트 PC                                                                         | * 파일 공유  |
              ↘↖                                                                             --------------
               파일서버


* 가까이 있는 파일 서버는 디렉터리를 지정해서 파일에 접근하다.
* 멀리 있는 웹 서버에서 IP 주소와 URL을 지정해서 인증을 받은 후 접근한다.
```  

## 외부에서 메일을 보고 싶을때 이용하는 서버

1. IMAP 서버의 역할  
**IMAP**(Internet Messaging Access Protocol)은 **외부에서 메일을 보고 싶을때 이용**된다.  
구체적으로 데스코톱PC로 메일을 주고받다가, 밖에서 스마트폰으로 메일을 확인하고 싶을때 이용하는 프로토콜 이다.  
예를들어, 현재 SMTP 와 POP3의 기능으로 회사 내에서 메일을 주고받을 수 있지만, 이후에 회사 밖에서도  
메일을 확인할 수 있게 하고싶을떄는 IMAP 서버나 IMAP 서비스를 추가한다.  
```
                                   IMAP 서버와 IMAP 서비스로 외부에서 인터넷을 경유해서 
                                   메일을 볼 수 있게 한다.              
SMTP 서버 ---->  POP3서버 ---->   IMAP 서버 
                                     ↑
                                     |
                                     |
                                   인터넷
                                  ↙     ↘
                               스마트폰    노트북  
```  

2. POP3와의 차이  
POP3의 경우는 메일 소프트웨어에서 POP3를 성정한 기기에 메일 데이터를 다운로드 한다.  
물론 POP3 서버에 메일 데이터를 남기도록 설정해두면 데이터는 서버에 남는다.  
반면에 IMAP은 POP3 서버의 메일을 보여 주기만 할 뿐이므로, IMAP으로 보는 한 메일 데이터는 서버 쪽에 있다.  
즉, IMAP는 열람할 수 있을뿐이므로, 암호 설정으로 단말을 열 수 없게 하면 보안 수준이 높다는 것을 의미한다.  
**외부에서 메일을 볼 수 있도록 사용자를 인증하는 기능을 갖춘 것이** IMAP 서버라고 생각하면 쉽다.  

## 인터넷 통신의 대행

1. 인터넷 통신대행  
**Proxy**는 대리를 의마한다. 즉, 클라이언트의 입장에서 보면, Proxy는 **인터넷 통신을 대행**한다.  
예를 들어, 복수의 클라이언트가 같은 사이트를 보러 가는 경우, 2대째 이후로는 Proxy에 있는 캐시 데이터를 보여줌으로써  
단순히 대리하는 것만이 아니라 효울화도 노리고 있다. 일반적으로 Proxy의 이런 기능을 사용자가 인지하는 일은 없다.  
```

같은 사이트에 대한 접속 요청이 있으면 
첫번째 방문 시 저장해 둔 Proxy의 캐시를 사용하여
두번째 방문부터는 효율화를 도모한다.

                     사용자 A ↘
                                          Proxy 서버    ⇆   인터넷
                     사용자 B ↗                        Proxy 서버는 내부 네트워크와        
                                                        인터넷 사이에서 액세스를 중계한다고 할 수 있다.       
```  

2. 내부에서의 차단
어떤 기업이나 단체에서 정책이나 운영 가이드라인 등에 의해,  
사이트에 따라서는 열람할 수 없거나 금지 기호가 표시되기도한다. 이것도 Proxy 서버의 기능이다.  
설정에 따라 **열람이 바람직하지 않은 사이트나 보안 측면에 문제가 있을 수 있는 사이트를 차단 한다.**  
또는 **외부에서의 부적절한 접근에 대해서 클라이언트를 보호하는 형태로 차단**하기도 한다. 이른바 방화벽의 역할이다.  
* 집에서 볼 수 있었던 유튜브등의 사이트를 회사에서는 진입 금지 마크와 경고가 표시되는 경우
* 외부에서 부적절한 엑세스로부터 클라이언트를 보호한다.



